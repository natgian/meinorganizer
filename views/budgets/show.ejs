<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../CSS/style.css">
  <title><%= foundBudget.name %></title>
</head>

<body>

  <div class="main-layout">

    <%- include("../partials/header") %>

    <main>
      <div class="container">

        <!-- Error-Alert -->
        <% if(error && error.length) {%>
        <div class="alert alert-error" role="alert">
          <%= error %>
        </div>
        <% } %>

        <div class="wrapper medium-dark-wrapper">

          <!-- Edit Button -->
          <button class="delete-edit-btn flex-right">
            <a href="/budget/<%=foundBudget._id%>/bearbeiten">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="m14.06 9l.94.94L5.92 19H5v-.92L14.06 9m3.6-6c-.25 0-.51.1-.7.29l-1.83 1.83l3.75 3.75l1.83-1.83c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75Z" />
              </svg></a>
          </button>

          <!-- Budget Title -->
          <h1 class="subtitle-specific">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="inline-block-svg"
              id="list-icon">
              <path fill="<%=foundBudget.color%>"
                d="M7 2h10a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 2v4h10V4H7m0 6v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2m-8 4v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2m-8 4v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2Z">
              </path>
            </svg>
            <%= foundBudget.name %>
          </h1>

          <!-- Budget-Table -->
          <table class="budget-table mt-2 mb-1">
            <tr>
              <th class="table-align-left bold">Budget</th>
              <th class="table-align-right bold">Verbleibend</th>
            </tr>
            <tr>
              <td class="table-align-left"><%= foundBudget.budget.toFixed(2) %> CHF</td>
              <td
                class="table-align-right <%= foundBudget.remainingBudget >= 0 ? "positive-remaining-budget" : "negative-remaining-budget" %>">
                <%= foundBudget.remainingBudget.toFixed(2) %> CHF</td>
            </tr>
          </table>

          <!-- Expenses-Table -->
          <table class="expenses-table mt-1">
            <tr>
              <th class="table-align-left bold">Beschreibung</th>
              <th class="table-align-right bold">Betrag</th>
            </tr>

            <% foundBudget.expenses.forEach((expense) => { %>
            <tr>
              <td class="table-align-left table-border"><%= expense.description %>
                <br><span class="expense-date"><%= formatDate(expense.date) %></span>
              </td>
              <td class="table-align-right table-align-top table-border"><%= expense.expense.toFixed(2) %> &nbsp;
                <form action="/budget/<%= foundBudget._id%>/expenses/<%=expense._id%>?_method=DELETE" method="POST"
                  class="expense-delete-form">
                  <button class="delete-edit-btn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                      viewBox="0 0 24 24">
                      <path fill="currentColor"
                        d="M7 21q-.825 0-1.413-.588T5 19V6q-.425 0-.713-.288T4 5q0-.425.288-.713T5 4h4q0-.425.288-.713T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5q0 .425-.288.713T19 6v13q0 .825-.588 1.413T17 21H7Zm5-7.1l1.9 1.9q.275.275.7.275t.7-.275q.275-.275.275-.7t-.275-.7l-1.9-1.9l1.9-1.9q.275-.275.275-.7t-.275-.7q-.275-.275-.7-.275t-.7.275L12 11.1l-1.9-1.9q-.275-.275-.7-.275t-.7.275q-.275.275-.275.7t.275.7l1.9 1.9l-1.9 1.9q-.275.275-.275.7t.275.7q.275.275.7.275t.7-.275l1.9-1.9Z" />
                    </svg></button>
                </form>
              </td>
            </tr>
            <% }) %>
          </table>

          <button class="round-btn mt-1" id="add-expense-btn"><svg xmlns="http://www.w3.org/2000/svg" width="26"
              height="26" viewBox="0 0 20 20">
              <path fill="currentColor" d="M11 9V5H9v4H5v2h4v4h2v-4h4V9h-4zm-1 11a10 10 0 1 1 0-20a10 10 0 0 1 0 20z" />
            </svg></button>

          <form action="/budget/<%= foundBudget._id %>" method="POST" autocomplete="off">
            <div class="new-item-container">
              <label for="expense-date">
                <input type="date" name="date" id="expense-date" class="input" autofocus required>
              </label>
              <label for="expense-description">
                <input type="text" name="description" placeholder="Beschreibung..." id="expense-description"
                  class="input" required>
              </label>
              <label for="expense-amount">
              <input type="number" name="expense" id="expense-amount" class="input" placeholder="Betrag..." step="any"
                required>
              </label>
              <button class="rectangle-btn">Hinzufügen</button>
            </div>
          </form>

        </div>
      </div>

      <div class="text-center">
        <a href="/budget" class="page-navigation-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
            viewBox="0 0 512 512" class="inline-block-svg">
            <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48"
              d="M328 112L184 256l144 144" />
          </svg>Budgetübersicht</a>
      </div>

    </main>




    <%- include("../partials/footer") %>
  </div>

  <script src="/JS/displayExpenseInput.js"></script>
</body>

</html>